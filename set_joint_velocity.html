<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setting Joint Velocites &mdash; Armer Manipulator Control Interface  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b3ba4146"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Setting Joint Positions" href="set_joint_position.html" />
    <link rel="prev" title="Supported Arms" href="supported_arms.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2c3e50" >

          
          
          <a href="index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="welcome.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="armer_installation.html">Armer Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_arms.html">Supported Arms</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setting Joint Velocites</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#via-python">Via Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-from-command-line">Testing from Command Line</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="set_joint_position.html">Setting Joint Positions</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_cartesian_velocity.html">Setting Cartesian Velocites</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_cartesian_position.html">Setting Cartesian Positions</a></li>
<li class="toctree-l1"><a class="reference internal" href="guarded_motion.html">Guarded Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="use_named_poses.html">Using Named Poses</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_a_hardware_package.html">Creating a Hardware Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_an_RTB_model.html">Creating a Robotics Toolbox Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_robot.html">Creating A Custom Robot</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="API.html">Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2c3e50" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Armer Manipulator Control Interface</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Setting Joint Velocites</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/set_joint_velocity.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="setting-joint-velocites">
<h1>Setting Joint Velocites<a class="headerlink" href="#setting-joint-velocites" title="Permalink to this heading">¶</a></h1>
<p>The Armer interface listens to ROS messages published on the <code class="docutils literal notranslate"><span class="pre">/arm/joint/velocity</span></code> topic to control joint velocity.</p>
<p>The user can publish to this topic to set the joint velocites of any or all of the joints on a manipulator.</p>
<section id="via-python">
<h2>Via Python<a class="headerlink" href="#via-python" title="Permalink to this heading">¶</a></h2>
<p>ROS topics can be published to from a Python script using Rospy, the ROS Python client.</p>
<p>The following code example shows the setting of joint velocities on a robot with 6 joints. Joints 1, 3, 4, 5, and 6 are set to 0 rad/s while the second joint from the base  is set to rotate at 0.1 rad/s in a clockwise direction.. The number of elements in the vel_msg.joints array should match with the joints on the target robot.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The joint will continue rotating till the script is killed (<code class="docutils literal notranslate"><span class="pre">ctrl+c</span></code>).</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">armer_msgs.msg</span> <span class="kn">import</span> <span class="n">JointVelocity</span>

<span class="c1"># Initialise node</span>
<span class="n">rospy</span><span class="o">.</span><span class="n">init_node</span><span class="p">(</span><span class="s1">&#39;armer_example&#39;</span><span class="p">,</span> <span class="n">disable_signals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Setup publisher</span>
<span class="n">vel_pub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Publisher</span><span class="p">(</span><span class="s1">&#39;/arm/joint/velocity&#39;</span><span class="p">,</span> <span class="n">JointVelocity</span><span class="p">,</span> <span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create message type and populate</span>
<span class="n">vel_msg</span> <span class="o">=</span> <span class="n">JointVelocity</span><span class="p">()</span>
<span class="n">vel_msg</span><span class="o">.</span><span class="n">joints</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

<span class="c1"># Define rate (100 Hz recommended)</span>
<span class="n">rate</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Rate</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#hz</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">():</span>
    <span class="c1"># Publish velocity</span>
    <span class="n">vel_pub</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">vel_msg</span><span class="p">)</span>
    <span class="c1"># Tick the node</span>
    <span class="n">rate</span><span class="o">.</span><span class="n">sleep</span><span class="p">()</span>
</pre></div>
</div>
<p>The length of the vel_msg.joints array will be dependent on the number of joints in the target manipulator. This example shows a 7 jointed arm.</p>
</section>
<section id="testing-from-command-line">
<h2>Testing from Command Line<a class="headerlink" href="#testing-from-command-line" title="Permalink to this heading">¶</a></h2>
<p>Publishing to the joint velocity topic can be done from the command line.</p>
<p>The ROS command to publish to a topic syntax begins with <code class="docutils literal notranslate"><span class="pre">rostopic</span> <span class="pre">pub</span></code> followed by the topic to publish to, the message type and finally the message itself to publish. This can be greatly simplfied on the command line by using tab to autocomplete.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unfortunately the autocomplete this message type is broken and should be manually corrected from <code class="docutils literal notranslate"><span class="pre">joints:-</span> <span class="pre">0&quot;</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;joints:</span> <span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0]&quot;</span></code> where the number of elements in the joints array corresponds to the number of joints on the manipulator.</p>
</div>
<p>The following code snippet displays an example of setting the velocty of the second joint of the manipulator to rotate at 0.1 rad/s.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-r</span></code> argument tells the node to publish continuously at 100 Hz. This example will continuously request the second joint of the manipulator to rotate at 0.1 rad/s so the robot will move until killed (<code class="docutils literal notranslate"><span class="pre">ctrl+c</span></code>).</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rostopic<span class="w"> </span>pub<span class="w"> </span>-r<span class="w"> </span><span class="m">100</span><span class="w"> </span>/arm/joint/velocity<span class="w"> </span>armer_msgs/JointVelocity<span class="w"> </span><span class="s2">&quot;joints: [0.0, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0]&quot;</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="supported_arms.html" class="btn btn-neutral float-left" title="Supported Arms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="set_joint_position.html" class="btn btn-neutral float-right" title="Setting Joint Positions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Gavin Suddrey.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>